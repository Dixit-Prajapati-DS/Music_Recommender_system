<!DOCTYPE html>
<html class="dark" lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Music Recommender</title>

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Spline+Sans:wght@400;500;600;700&display=swap"
        rel="stylesheet" />

    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
         /* Custom suggestion dropdown */
        .custom-suggestions {
            position: absolute;
            background: #1e3a8a;
            color: white;
            border-radius: 0.5rem;
            padding: 0.25rem 0;
            width: 100%;
            z-index: 50;
            max-height: 180px;
            overflow-y: auto;
            display: none;
        }

        .custom-suggestions div {
            padding: 0.5rem 0.75rem;
            cursor: pointer;
        }

        .custom-suggestions div:hover {
            background: #1d4ed8;
        }
    </style>



    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#7f13ec",
                        "background-light": "#f7f6f8",
                        "background-dark": "#191022",
                    },
                    fontFamily: {
                        display: ["Spline Sans", "sans-serif"]
                    }
                }
            }
        }
    </script>




</head>

<body class="bg-background-light dark:bg-background-dark font-display text-gray-800 dark:text-gray-200">

    <div class="flex min-h-screen flex-col">






        <!-- Header -->
        <header class="flex items-center justify-between w-full border-b border-white/10 px-4 py-4">
            <div class="flex items-center gap-3 text-white">
                <!-- For add a blue box befor movie Recommender -->
                <div class="size-4 text-primary">
                    <svg fill="none" viewbox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M36.7273 44C33.9891 44 31.6043 39.8386 30.3636 33.69C29.123 39.8386 26.7382 44 24 44C21.2618 44 18.877 39.8386 17.6364 33.69C16.3957 39.8386 14.0109 44 11.2727 44C7.25611 44 4 35.0457 4 24C4 12.9543 7.25611 4 11.2727 4C14.0109 4 16.3957 8.16144 17.6364 14.31C18.877 8.16144 21.2618 4 24 4C26.7382 4 29.123 8.16144 30.3636 14.31C31.6043 8.16144 33.9891 4 36.7273 4C40.7439 4 44 12.9543 44 24C44 35.0457 40.7439 44 36.7273 44Z"
                            fill="currentColor"></path>
                    </svg>
                </div>


                <h2 class="text-lg font-bold">Recommender System</h2>
            </div>

            <div class="flex items-center gap-6">
                <a href="/home" class="text-sm text-gray-300 hover:text-white">Home</a>
                <a href="/linkedin" class="text-sm text-gray-300 hover:text-white">LinkedIn</a>
                <a href="/github" class="text-sm text-gray-300 hover:text-white">GitHub</a>
            </div>
        </header>

        <main class="flex flex-col items-center w-full px-4 py-10 gap-12">
            
            <!-- Input Section -->
            <section class="w-full max-w-xl bg-white/5 p-6 rounded-lg shadow-md">
                <h1 class="text-2xl font-semibold text-white mb-4">Enter a Song</h1>

                <form method="post">
                    <label for="song-input" class="text-sm text-gray-300">Song name</label>

                    <input name="song-input" id="song-input"
                        class="w-full mt-2 mb-4 px-4 py-3 rounded-lg bg-white/5 border border-white/10 text-white placeholder-gray-400"
                        placeholder="Type a song">


                        



                    <datalist id="song-list" style="background-color: blue;">
                        {% for song in Data %}
                        <option value="{{song}}" class="background-color: blue;" ></option>
                        {% endfor %}
                    </datalist>

                    <button
                        class="w-full sm:w-auto px-8 py-3 bg-primary text-white rounded-lg hover:bg-primary/90 font-bold">
                        Recommend
                    </button>

                    
                    


                
                 </form>
            </section>






                <!-- Results Section -->
{% if songs %}
<section class="w-full max-w-5xl">
    <h2 class="text-2xl font-semibold text-white mb-6">
        Recommendations based on:
        <span class="text-primary">{{original_song}}</span>
    </h2>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for i in range(songs|length) %}
        <div class="group relative bg-white/5 p-6 rounded-lg hover:bg-white/10 transition-all duration-300">
            <!-- Poster with Play Button Overlay -->
            <div class="relative w-24 h-24 flex-shrink-0 mx-auto mb-4 group-hover:scale-105 transition-transform">
                <img class="w-full h-full object-cover rounded-md cursor-pointer" 
                     src="{{poster[i]}}" 
                     alt="{{songs[i]}}" 
                     onclick="toggleAudio('{{i}}')">
                
                <!-- Play Icon Overlay -->
                <div class="absolute inset-0 bg-black/20 rounded-md opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                    <svg class="w-10 h-10 text-white fill-current" viewBox="0 0 24 24">
                        <path d="M8 5v14l11-7z"/>
                    </svg>
                </div>
            </div>

            <!-- Song info -->
            <div class="text-center">
                <p class="font-semibold text-white text-lg whitespace-normal break-words mb-2">{{songs[i]}}</p>
                <p class="text-sm text-gray-400 whitespace-normal break-words mb-4">{{author[i]}}</p>
            </div>

            <!-- Audio Player - Hidden by default -->
            {% if preview[i] %}
            <div id="audio-container-{{i}}" class="audio-container mt-4 opacity-0 scale-95 group-hover:opacity-100 group-hover:scale-100 transition-all duration-300">
                <audio class="w-full" id="audio-{{i}}" preload="none">
                    <source src="{{preview[i]}}" type="audio/mpeg">
                    Your browser does not support audio.
                </audio>
                <div class="flex items-center mt-2 text-xs text-gray-400">
                    <span id="audio-status-{{i}}" class="flex-1">Click album to play</span>
                    <button onclick="toggleAudio('{{i}}')" class="ml-2 p-1 hover:text-white">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                    </button>
                </div>
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</section>
{% endif %}








        </main>
    </div>
<footer>
<h2 align="right " class="text-lg font-bold leading-tight tracking-tight" >Created By: Dixit</h2>
</footer>    
<script>
function toggleAudio(index) {
    const audio = document.getElementById(`audio-${index}`);
    const status = document.getElementById(`audio-status-${index}`);
    const container = document.getElementById(`audio-container-${index}`);
    
    if (audio.paused) {
        audio.play();
        status.textContent = 'Playing...';
        container.style.opacity = '1';
        container.style.scale = '1';
    } else {
        audio.pause();
        audio.currentTime = 0;
        status.textContent = 'Click to play';
    }
}

// Pause all other audios when one starts playing
document.querySelectorAll('audio').forEach(audio => {
    audio.addEventListener('play', function() {
        document.querySelectorAll('audio').forEach(otherAudio => {
            if (otherAudio !== this) {
                otherAudio.pause();
                otherAudio.currentTime = 0;
            }
        });
    });
});
</script>


<!-- <script>
        const input = document.getElementById("song-input");
        const dataList = document.getElementById("song-list");
        const box = document.querySelector(".custom-suggestions");

        input.addEventListener("input", () => {
            const value = input.value.toLowerCase();
            const items = [...dataList.options]
                .filter(opt => opt.value.toLowerCase().includes(value))
                .slice(0, 8);

            box.innerHTML = "";
            if (items.length === 0 || value.length === 0) {
                box.style.display = "none";
                return;
            }

            items.forEach(opt => {
                const div = document.createElement("div");
                div.textContent = opt.value;
                div.onclick = () => {
                    input.value = opt.value;
                    box.style.display = "none";
                };
                box.appendChild(div);
            });

            box.style.top = input.offsetHeight + "px";
            box.style.left = "0px";
            box.style.display = "block";
        });

        document.addEventListener("click", e => {
            if (!input.contains(e.target)) box.style.display = "none";
        });
    </script> -->
<script>
    const input = document.getElementById("song-input");
    const dataList = document.getElementById("song-list");

    // Create suggestion box only once
    let box = document.querySelector(".custom-suggestions");
    if (!box) {
        box = document.createElement("div");
        box.className = "custom-suggestions";
        input.parentElement.style.position = "relative";
        input.parentElement.appendChild(box);
    }

    input.addEventListener("input", () => {
        const value = input.value.trim().toLowerCase();
        const items = [...dataList.options]
            .filter(opt => opt.value.toLowerCase().includes(value))
            .slice(0, 8);

        box.innerHTML = "";

        if (!value || items.length === 0) {
            box.style.display = "none";
            return;
        }

        items.forEach(opt => {
            const item = document.createElement("div");
            item.textContent = opt.value;
            item.onclick = () => {
                input.value = opt.value;
                box.style.display = "none";
            };
            box.appendChild(item);
        });

        const rect = input.getBoundingClientRect();
        const parentRect = input.parentElement.getBoundingClientRect();

        box.style.width = rect.width + "px";
        box.style.left = rect.left - parentRect.left + "px";
        box.style.top = rect.height + "px";

        box.style.display = "block";
    });

    // Hide when clicking outside
    document.addEventListener("click", e => {
        if (e.target !== input && !box.contains(e.target)) {
            box.style.display = "none";
        }
    });
</script>




</body>

</html>


